(function(c,u){typeof exports=="object"&&typeof module<"u"?u(exports):typeof define=="function"&&define.amd?define(["exports"],u):(c=typeof globalThis<"u"?globalThis:c||self,u(c.maplibreSearchBox={}))})(this,function(c){"use strict";var pt=Object.defineProperty;var gt=(c,u,y)=>u in c?pt(c,u,{enumerable:!0,configurable:!0,writable:!0,value:y}):c[u]=y;var r=(c,u,y)=>gt(c,typeof u!="symbol"?u+"":u,y);const u="https://api.stadiamaps.com".replace(/\/+$/,"");class y{constructor(n={}){this.configuration=n}set config(n){this.configuration=n}get basePath(){return this.configuration.basePath!=null?this.configuration.basePath:u}get fetchApi(){return this.configuration.fetchApi}get middleware(){return this.configuration.middleware||[]}get queryParamsStringify(){return this.configuration.queryParamsStringify||w}get username(){return this.configuration.username}get password(){return this.configuration.password}get apiKey(){const n=this.configuration.apiKey;if(n)return typeof n=="function"?n:()=>n}get accessToken(){const n=this.configuration.accessToken;if(n)return typeof n=="function"?n:async()=>n}get headers(){return this.configuration.headers}get credentials(){return this.configuration.credentials}}const C=new y,f=class T{constructor(n=C){this.configuration=n,this.fetchApi=async(e,o)=>{let a={url:e,init:o};for(const i of this.middleware)i.pre&&(a=await i.pre({fetch:this.fetchApi,...a})||a);let s;try{s=await(this.configuration.fetchApi||fetch)(a.url,a.init)}catch(i){for(const l of this.middleware)l.onError&&(s=await l.onError({fetch:this.fetchApi,url:a.url,init:a.init,error:i,response:s?s.clone():void 0})||s);if(s===void 0)throw i instanceof Error?new Z(i,"The request failed and the interceptors did not return an alternative response"):i}for(const i of this.middleware)i.post&&(s=await i.post({fetch:this.fetchApi,url:a.url,init:a.init,response:s.clone()})||s);return s},this.middleware=n.middleware}withMiddleware(...n){const e=this.clone();return e.middleware=e.middleware.concat(...n),e}withPreMiddleware(...n){const e=n.map(o=>({pre:o}));return this.withMiddleware(...e)}withPostMiddleware(...n){const e=n.map(o=>({post:o}));return this.withMiddleware(...e)}isJsonMime(n){return n?T.jsonRegex.test(n):!1}async request(n,e){const{url:o,init:a}=await this.createFetchParams(n,e),s=await this.fetchApi(o,a);if(s&&s.status>=200&&s.status<300)return s;throw new S(s,"Response returned an error code")}async createFetchParams(n,e){let o=this.configuration.basePath+n.path;n.query!==void 0&&Object.keys(n.query).length!==0&&(o+="?"+this.configuration.queryParamsStringify(n.query));const a=Object.assign({},this.configuration.headers,n.headers);Object.keys(a).forEach(L=>a[L]===void 0?delete a[L]:{});const s=typeof e=="function"?e:async()=>e,i={method:n.method,headers:a,body:n.body,credentials:this.configuration.credentials},l={...i,...await s({init:i,context:n})};let h;k(l.body)||l.body instanceof URLSearchParams||_(l.body)?h=l.body:this.isJsonMime(a["Content-Type"])?h=JSON.stringify(l.body):h=l.body;const v={...l,body:h};return{url:o,init:v}}clone(){const n=this.constructor,e=new n(this.configuration);return e.middleware=this.middleware.slice(),e}};f.jsonRegex=new RegExp("^(:?application/json|[^;/ 	]+/[^;/ 	]+[+]json)[ 	]*(:?;.*)?$","i");let M=f;function _(t){return typeof Blob<"u"&&t instanceof Blob}function k(t){return typeof FormData<"u"&&t instanceof FormData}class S extends Error{constructor(n,e){super(e),this.response=n,this.name="ResponseError"}}class Z extends Error{constructor(n,e){super(e),this.cause=n,this.name="FetchError"}}class m extends Error{constructor(n,e){super(e),this.field=n,this.name="RequiredError"}}const d={csv:",",ssv:" ",tsv:"	",pipes:"|"};function w(t,n=""){return Object.keys(t).map(e=>q(e,t[e],n)).filter(e=>e.length>0).join("&")}function q(t,n,e=""){const o=e+(e.length?`[${t}]`:t);if(n instanceof Array){const a=n.map(s=>encodeURIComponent(String(s))).join(`&${encodeURIComponent(o)}=`);return`${encodeURIComponent(o)}=${a}`}if(n instanceof Set){const a=Array.from(n);return q(t,a,e)}return n instanceof Date?`${encodeURIComponent(o)}=${encodeURIComponent(n.toISOString())}`:n instanceof Object?w(n,o):`${encodeURIComponent(o)}=${encodeURIComponent(String(n))}`}class p{constructor(n,e=o=>o){this.raw=n,this.transformer=e}async value(){return this.transformer(await this.raw.json())}}function x(t){return t}function P(t){return E(t)}function E(t,n){return t}function R(t){return t}function I(t){return"text"in t}function j(t){return z(t,!1)}function z(t,n=!1){return t==null?t:{text:t.text,"focus.point.lat":t.focusPointLat,"focus.point.lon":t.focusPointLon,"boundary.rect.min_lat":t.boundaryRectMinLat,"boundary.rect.max_lat":t.boundaryRectMaxLat,"boundary.rect.min_lon":t.boundaryRectMinLon,"boundary.rect.max_lon":t.boundaryRectMaxLon,"boundary.circle.lat":t.boundaryCircleLat,"boundary.circle.lon":t.boundaryCircleLon,"boundary.circle.radius":t.boundaryCircleRadius,"boundary.country":t.boundaryCountry,"boundary.gid":t.boundaryGid,layers:t.layers==null?void 0:t.layers.map(R),sources:t.sources==null?void 0:t.sources.map(x),size:t.size,lang:t.lang}}function A(t){return G(t,!1)}function G(t,n=!1){return t==null?t:{address:t.address,neighbourhood:t.neighbourhood,borough:t.borough,locality:t.locality,county:t.county,region:t.region,postalCode:t.postalCode,country:t.country,"focus.point.lat":t.focusPointLat,"focus.point.lon":t.focusPointLon,"boundary.rect.min_lat":t.boundaryRectMinLat,"boundary.rect.max_lat":t.boundaryRectMaxLat,"boundary.rect.min_lon":t.boundaryRectMinLon,"boundary.rect.max_lon":t.boundaryRectMaxLon,"boundary.circle.lat":t.boundaryCircleLat,"boundary.circle.lon":t.boundaryCircleLon,"boundary.circle.radius":t.boundaryCircleRadius,"boundary.country":t.boundaryCountry,"boundary.gid":t.boundaryGid,layers:t.layers==null?void 0:t.layers.map(R),sources:t.sources==null?void 0:t.sources.map(x),size:t.size,lang:t.lang}}function B(t){return t==null?t:I(t)?j(t):A(t)}function F(t){return t==null?t:{endpoint:t.endpoint,query:B(t.query)}}function O(t){return K(t)}function K(t,n){return t==null?t:{attribution:t.attribution==null?void 0:t.attribution,query:t.query==null?void 0:t.query,warnings:t.warnings==null?void 0:t.warnings,errors:t.errors==null?void 0:t.errors}}function N(t){return H(t)}function H(t,n){return t==null?t:{type:t.type,coordinates:t.coordinates}}function D(t){return U(t)}function U(t,n){return t==null?t:{...t,website:t.website==null?void 0:t.website,wikipedia:t.wikipedia==null?void 0:t.wikipedia,wikidata:t.wikidata==null?void 0:t.wikidata,phone:t.phone==null?void 0:t.phone}}function $(t){return V(t)}function V(t,n){return t==null?t:{...t,osm:t.osm==null?void 0:D(t.osm)}}function J(t){return W(t)}function W(t,n){return t==null?t:{...t,gid:t.gid==null?void 0:t.gid,sourceId:t.source_id==null?void 0:t.source_id,label:t.label==null?void 0:t.label,layer:t.layer==null?void 0:P(t.layer),source:t.source==null?void 0:t.source,name:t.name==null?void 0:t.name,accuracy:t.accuracy==null?void 0:t.accuracy,addendum:t.addendum==null?void 0:$(t.addendum),continent:t.continent==null?void 0:t.continent,continentGid:t.continent_gid==null?void 0:t.continent_gid,country:t.country==null?void 0:t.country,countryA:t.country_a==null?void 0:t.country_a,countryCode:t.country_code==null?void 0:t.country_code,countryGid:t.country_gid==null?void 0:t.country_gid,neighbourhood:t.neighbourhood==null?void 0:t.neighbourhood,neighbourhoodGid:t.neighbourhood_gid==null?void 0:t.neighbourhood_gid,borough:t.borough==null?void 0:t.borough,boroughGid:t.borough_gid==null?void 0:t.borough_gid,postalcode:t.postalcode==null?void 0:t.postalcode,street:t.street==null?void 0:t.street,housenumber:t.housenumber==null?void 0:t.housenumber,locality:t.locality==null?void 0:t.locality,localityGid:t.locality_gid==null?void 0:t.locality_gid,county:t.county==null?void 0:t.county,countyGid:t.county_gid==null?void 0:t.county_gid,region:t.region==null?void 0:t.region,regionA:t.region_a==null?void 0:t.region_a,regionGid:t.region_gid==null?void 0:t.region_gid,localadmin:t.localadmin==null?void 0:t.localadmin,localadminGid:t.localadmin_gid==null?void 0:t.localadmin_gid,matchType:t.match_type==null?void 0:t.match_type}}function Q(t){return Y(t)}function Y(t,n){return t==null?t:{type:t.type,geometry:N(t.geometry),properties:t.properties==null?void 0:J(t.properties),bbox:t.bbox==null?void 0:t.bbox}}function g(t){return X(t)}function X(t,n){return t==null?t:{geocoding:O(t.geocoding),bbox:t.bbox==null?void 0:t.bbox,features:t.features.map(Q)}}function tt(t){return et(t)}function et(t,n){return t==null?t:{status:t.status,response:t.response==null?void 0:g(t.response),msg:t.msg==null?void 0:t.msg}}let nt=class extends M{async autocompleteRaw(t,n){if(t.text==null)throw new m("text",'Required parameter "text" was null or undefined when calling autocomplete().');const e={};t.text!=null&&(e.text=t.text),t.focusPointLat!=null&&(e["focus.point.lat"]=t.focusPointLat),t.focusPointLon!=null&&(e["focus.point.lon"]=t.focusPointLon),t.boundaryRectMinLat!=null&&(e["boundary.rect.min_lat"]=t.boundaryRectMinLat),t.boundaryRectMaxLat!=null&&(e["boundary.rect.max_lat"]=t.boundaryRectMaxLat),t.boundaryRectMinLon!=null&&(e["boundary.rect.min_lon"]=t.boundaryRectMinLon),t.boundaryRectMaxLon!=null&&(e["boundary.rect.max_lon"]=t.boundaryRectMaxLon),t.boundaryCircleLat!=null&&(e["boundary.circle.lat"]=t.boundaryCircleLat),t.boundaryCircleLon!=null&&(e["boundary.circle.lon"]=t.boundaryCircleLon),t.boundaryCircleRadius!=null&&(e["boundary.circle.radius"]=t.boundaryCircleRadius),t.boundaryCountry!=null&&(e["boundary.country"]=t.boundaryCountry.join(d.csv)),t.boundaryGid!=null&&(e["boundary.gid"]=t.boundaryGid),t.layers!=null&&(e.layers=t.layers.join(d.csv)),t.sources!=null&&(e.sources=t.sources.join(d.csv)),t.size!=null&&(e.size=t.size),t.lang!=null&&(e.lang=t.lang);const o={};this.configuration&&this.configuration.apiKey&&(e.api_key=await this.configuration.apiKey("api_key"));const a=await this.request({path:"/geocoding/v1/autocomplete",method:"GET",headers:o,query:e},n);return new p(a,s=>g(s))}async autocomplete(t,n){return await(await this.autocompleteRaw(t,n)).value()}async placeRaw(t,n){if(t.ids==null)throw new m("ids",'Required parameter "ids" was null or undefined when calling place().');const e={};t.ids!=null&&(e.ids=t.ids.join(d.csv)),t.lang!=null&&(e.lang=t.lang);const o={};this.configuration&&this.configuration.apiKey&&(e.api_key=await this.configuration.apiKey("api_key"));const a=await this.request({path:"/geocoding/v1/place",method:"GET",headers:o,query:e},n);return new p(a,s=>g(s))}async place(t,n){return await(await this.placeRaw(t,n)).value()}async reverseRaw(t,n){if(t.pointLat==null)throw new m("pointLat",'Required parameter "pointLat" was null or undefined when calling reverse().');if(t.pointLon==null)throw new m("pointLon",'Required parameter "pointLon" was null or undefined when calling reverse().');const e={};t.pointLat!=null&&(e["point.lat"]=t.pointLat),t.pointLon!=null&&(e["point.lon"]=t.pointLon),t.boundaryCircleRadius!=null&&(e["boundary.circle.radius"]=t.boundaryCircleRadius),t.layers!=null&&(e.layers=t.layers.join(d.csv)),t.sources!=null&&(e.sources=t.sources.join(d.csv)),t.boundaryCountry!=null&&(e["boundary.country"]=t.boundaryCountry.join(d.csv)),t.boundaryGid!=null&&(e["boundary.gid"]=t.boundaryGid),t.size!=null&&(e.size=t.size),t.lang!=null&&(e.lang=t.lang);const o={};this.configuration&&this.configuration.apiKey&&(e.api_key=await this.configuration.apiKey("api_key"));const a=await this.request({path:"/geocoding/v1/reverse",method:"GET",headers:o,query:e},n);return new p(a,s=>g(s))}async reverse(t,n){return await(await this.reverseRaw(t,n)).value()}async searchRaw(t,n){if(t.text==null)throw new m("text",'Required parameter "text" was null or undefined when calling search().');const e={};t.text!=null&&(e.text=t.text),t.focusPointLat!=null&&(e["focus.point.lat"]=t.focusPointLat),t.focusPointLon!=null&&(e["focus.point.lon"]=t.focusPointLon),t.boundaryRectMinLat!=null&&(e["boundary.rect.min_lat"]=t.boundaryRectMinLat),t.boundaryRectMaxLat!=null&&(e["boundary.rect.max_lat"]=t.boundaryRectMaxLat),t.boundaryRectMinLon!=null&&(e["boundary.rect.min_lon"]=t.boundaryRectMinLon),t.boundaryRectMaxLon!=null&&(e["boundary.rect.max_lon"]=t.boundaryRectMaxLon),t.boundaryCircleLat!=null&&(e["boundary.circle.lat"]=t.boundaryCircleLat),t.boundaryCircleLon!=null&&(e["boundary.circle.lon"]=t.boundaryCircleLon),t.boundaryCircleRadius!=null&&(e["boundary.circle.radius"]=t.boundaryCircleRadius),t.boundaryCountry!=null&&(e["boundary.country"]=t.boundaryCountry.join(d.csv)),t.boundaryGid!=null&&(e["boundary.gid"]=t.boundaryGid),t.layers!=null&&(e.layers=t.layers.join(d.csv)),t.sources!=null&&(e.sources=t.sources.join(d.csv)),t.size!=null&&(e.size=t.size),t.lang!=null&&(e.lang=t.lang);const o={};this.configuration&&this.configuration.apiKey&&(e.api_key=await this.configuration.apiKey("api_key"));const a=await this.request({path:"/geocoding/v1/search",method:"GET",headers:o,query:e},n);return new p(a,s=>g(s))}async search(t,n){return await(await this.searchRaw(t,n)).value()}async searchBulkRaw(t,n){const e={},o={};o["Content-Type"]="application/json",this.configuration&&this.configuration.apiKey&&(e.api_key=await this.configuration.apiKey("api_key"));const a=await this.request({path:"/geocoding/v1/search/bulk",method:"POST",headers:o,query:e,body:t.bulkRequest.map(F)},n);return new p(a,s=>s.map(tt))}async searchBulk(t={},n){return await(await this.searchBulkRaw(t,n)).value()}async searchStructuredRaw(t,n){const e={};t.address!=null&&(e.address=t.address),t.neighbourhood!=null&&(e.neighbourhood=t.neighbourhood),t.borough!=null&&(e.borough=t.borough),t.locality!=null&&(e.locality=t.locality),t.county!=null&&(e.county=t.county),t.region!=null&&(e.region=t.region),t.postalcode!=null&&(e.postalcode=t.postalcode),t.country!=null&&(e.country=t.country),t.focusPointLat!=null&&(e["focus.point.lat"]=t.focusPointLat),t.focusPointLon!=null&&(e["focus.point.lon"]=t.focusPointLon),t.boundaryRectMinLat!=null&&(e["boundary.rect.min_lat"]=t.boundaryRectMinLat),t.boundaryRectMaxLat!=null&&(e["boundary.rect.max_lat"]=t.boundaryRectMaxLat),t.boundaryRectMinLon!=null&&(e["boundary.rect.min_lon"]=t.boundaryRectMinLon),t.boundaryRectMaxLon!=null&&(e["boundary.rect.max_lon"]=t.boundaryRectMaxLon),t.boundaryCircleLat!=null&&(e["boundary.circle.lat"]=t.boundaryCircleLat),t.boundaryCircleLon!=null&&(e["boundary.circle.lon"]=t.boundaryCircleLon),t.boundaryCircleRadius!=null&&(e["boundary.circle.radius"]=t.boundaryCircleRadius),t.boundaryCountry!=null&&(e["boundary.country"]=t.boundaryCountry.join(d.csv)),t.boundaryGid!=null&&(e["boundary.gid"]=t.boundaryGid),t.layers!=null&&(e.layers=t.layers.join(d.csv)),t.sources!=null&&(e.sources=t.sources.join(d.csv)),t.size!=null&&(e.size=t.size),t.lang!=null&&(e.lang=t.lang);const o={};this.configuration&&this.configuration.apiKey&&(e.api_key=await this.configuration.apiKey("api_key"));const a=await this.request({path:"/geocoding/v1/search/structured",method:"GET",headers:o,query:e},n);return new p(a,s=>g(s))}async searchStructured(t={},n){return await(await this.searchStructuredRaw(t,n)).value()}};class ot extends nt{constructor(){super(...arguments),this.cache=new Map}async autocomplete(n,e){let o=e===null?"null":typeof e=="function"?e.toString():JSON.stringify(e);const a=JSON.stringify(n)+o;if(this.cache.has(a))return this.cache.get(a);let s=await super.autocomplete(n,e);if(this.cache.size>=20){const i=this.cache.keys().next().value;this.cache.delete(i)}return this.cache.set(a,s),s}}const st="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Generator:%20Adobe%20Illustrator%2019.1.0,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%206.00%20Build%200)%20--%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20viewBox='0%200%20176.179%20172.152'%20style='enable-background:new%200%200%20176.179%20172.152;'%20xml:space='preserve'%3e%3cstyle%20type='text/css'%3e%20.st0{fill:%23333333;}%20%3c/style%3e%3cg%3e%3cg%3e%3cpath%20class='st0'%20d='M89.244,97.036c4.036-18.534,11.259-25.237,15.416-34.469l0.043-0.099c1.039-2.2,1.533-4.543,1.533-7.141%20c0-9.388-7.621-16.975-17.044-16.975s-16.975,7.587-16.975,16.975c0,2.598,0.554,5.023,1.594,7.223%20c4.122,9.25,11.328,15.936,15.381,34.469L89.244,97.036z%20M84.463,50.494c0-2.631,2.133-4.763,4.763-4.763%20c2.631,0,4.763,2.133,4.763,4.763c0,2.631-2.133,4.763-4.763,4.763C86.596,55.257,84.463,53.124,84.463,50.494z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st0'%20d='M37.081,94.068l-13.488,10.967c-3.591,2.92-3.446,6.533,0.388,8.047l43.014,16.991l20.175-17.865%20L37.081,94.068z%20M66.497,126.347L26.73,110.822c-2.237-0.873-2.341-2.974-0.254-4.68l10.858-8.872l43.913,16.089L66.497,126.347z'%20/%3e%3c/g%3e%3cg%3e%3cpath%20class='st0'%20d='M70.289,131.375l17.082,6.747c4.585,1.811,11.33,0.53,14.956-2.846l13.59-12.656l-25.449-9.217%20L70.289,131.375z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st0'%20d='M91.374,98.976c-0.208,1.005-1.109,1.732-2.13,1.732v-0.017c-1.039,0-1.905-0.693-2.148-1.732%20c-1.148-5.242-2.552-9.616-4.07-13.432l-18.171,15.416l53.697,19.223l20.073-18.694L94.798,87.135%20C93.524,90.567,92.351,94.445,91.374,98.976z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st0'%20d='M150.796,79.922L108.039,67.22c0.427-0.848,0.842-1.702,1.228-2.575l0.173-0.346%20c1.264-2.858,1.905-5.855,1.905-8.972c0-12.194-9.925-22.119-22.137-22.119c-12.194,0-22.102,9.925-22.119,22.119%20c0,3.256,0.693,6.426,2.079,9.319c0.369,0.815,0.759,1.607,1.157,2.392l-30.623,24.9l22.086,7.906l20.126-16.985%20c-1.885-4.287-3.888-7.854-5.765-11.198c-1.136-2.02-2.23-3.989-3.236-5.979c-0.376-0.74-0.751-1.48-1.094-2.231%20c-1.161-2.529-1.767-5.3-1.767-8.141c0-10.566,8.574-19.157,19.157-19.157c10.601,0,19.227,8.591,19.227,19.175%20c0,2.737-0.676,5.595-1.819,8.124c-0.52,1.188-1.102,2.354-1.716,3.518c-0.817,1.551-1.695,3.099-2.615,4.692%20c-0.361,0.644-0.728,1.299-1.097,1.963c-0.027,0.049-0.054,0.096-0.081,0.145l0.001-0.001c-1.384,2.494-2.804,5.161-4.172,8.179%20l-0.004-0.001c-0.029,0.064-0.057,0.133-0.085,0.197c-0.067,0.15-0.136,0.294-0.203,0.446l0.008,0.003%20c-0.279,0.629-0.559,1.258-0.833,1.921l45.29,14.646l12.311-11.465C156.571,84.76,155.362,81.278,150.796,79.922z%20M149.922,86.624%20l-9.847,9.114L99.773,82.853c1.676-3.654,3.424-6.805,5.077-9.755c0.67-1.188,1.318-2.348,1.947-3.508l41.627,12.507%20C151.077,82.895,151.759,84.924,149.922,86.624z'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",at="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='%23000'%3e%3cpath%20d='M480-480q33%200%2056.5-23.5T560-560q0-33-23.5-56.5T480-640q-33%200-56.5%2023.5T400-560q0%2033%2023.5%2056.5T480-480Zm0%20294q122-112%20181-203.5T720-552q0-109-69.5-178.5T480-800q-101%200-170.5%2069.5T240-552q0%2071%2059%20162.5T480-186Zm0%20106Q319-217%20239.5-334.5T160-552q0-150%2096.5-239T480-880q127%200%20223.5%2089T800-552q0%20100-79.5%20217.5T480-80Zm0-480Z'/%3e%3c/svg%3e",rt="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='%23000'%3e%3cpath%20d='M220-360v-180h-60v-60h120v240h-60Zm140%200v-100q0-17%2011.5-28.5T400-500h80v-40H360v-60h140q17%200%2028.5%2011.5T540-560v60q0%2017-11.5%2028.5T500-460h-80v40h120v60H360Zm240%200v-60h120v-40h-80v-40h80v-40H600v-60h140q17%200%2028.5%2011.5T780-560v160q0%2017-11.5%2028.5T740-360H600Z'/%3e%3c/svg%3e",it="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='000000'%3e%3cpath%20d='M160-160v-640h80v640h-80Zm280%200v-160h80v160h-80Zm280%200v-640h80v640h-80ZM440-400v-160h80v160h-80Zm0-240v-160h80v160h-80Z'/%3e%3c/svg%3e",lt="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='000000'%3e%3cpath%20d='M640-200v80q0%2017-11.5%2028.5T600-80H120q-17%200-28.5-11.5T80-120v-320q0-17%2011.5-28.5T120-480h120v-160q0-100%2070-170t170-70h160q100%200%20170%2070t70%20170v560h-80v-120H640Zm0-80h160v-360q0-66-47-113t-113-47H480q-66%200-113%2047t-47%20113v160h280q17%200%2028.5%2011.5T640-440v160ZM400-560v-80h320v80H400Zm-40%20274%20200-114H160l200%20114Zm0%2070L160-330v170h400v-170L360-216ZM160-400v240-240Z'/%3e%3c/svg%3e",ct="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='000000'%3e%3cpath%20d='M480-160q18%200%2034.5-2t33.5-6l-48-72H360v-40q0-33%2023.5-56.5T440-360h80v-120h-80q-17%200-28.5-11.5T400-520v-80h-18q-26%200-44-17.5T320-661q0-9%202.5-18t7.5-17l62-91q-101%2029-166.5%20113T160-480h40v-40q0-17%2011.5-28.5T240-560h80q17%200%2028.5%2011.5T360-520v40q0%2017-11.5%2028.5T320-440v40q0%2033-23.5%2056.5T240-320h-37q42%2072%20115%20116t162%2044Zm304-222q8-23%2012-47.5t4-50.5q0-112-68-197.5T560-790v110q33%200%2056.5%2023.5T640-600v80q19%200%2034%204.5t29%2018.5l81%20115ZM480-80q-83%200-156-31.5T197-197q-54-54-85.5-127T80-480q0-83%2031.5-156T197-763q54-54%20127-85.5T480-880q83%200%20156%2031.5T763-763q54%2054%2085.5%20127T880-480q0%2083-31.5%20156T763-197q-54%2054-127%2085.5T480-80Z'/%3e%3c/svg%3e",ut="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='000000'%3e%3cpath%20d='M480-80q-82%200-155-31.5t-127.5-86Q143-252%20111.5-325T80-480q0-83%2031.5-155.5t86-127Q252-817%20325-848.5T480-880q83%200%20155.5%2031.5t127%2086q54.5%2054.5%2086%20127T880-480q0%2082-31.5%20155t-86%20127.5q-54.5%2054.5-127%2086T480-80Zm0-82q26-36%2045-75t31-83H404q12%2044%2031%2083t45%2075Zm-104-16q-18-33-31.5-68.5T322-320H204q29%2050%2072.5%2087t99.5%2055Zm208%200q56-18%2099.5-55t72.5-87H638q-9%2038-22.5%2073.5T584-178ZM170-400h136q-3-20-4.5-39.5T300-480q0-21%201.5-40.5T306-560H170q-5%2020-7.5%2039.5T160-480q0%2021%202.5%2040.5T170-400Zm216%200h188q3-20%204.5-39.5T580-480q0-21-1.5-40.5T574-560H386q-3%2020-4.5%2039.5T380-480q0%2021%201.5%2040.5T386-400Zm268%200h136q5-20%207.5-39.5T800-480q0-21-2.5-40.5T790-560H654q3%2020%204.5%2039.5T660-480q0%2021-1.5%2040.5T654-400Zm-16-240h118q-29-50-72.5-87T584-782q18%2033%2031.5%2068.5T638-640Zm-234%200h152q-12-44-31-83t-45-75q-26%2036-45%2075t-31%2083Zm-200%200h118q9-38%2022.5-73.5T376-782q-56%2018-99.5%2055T204-640Z'/%3e%3c/svg%3e",dt="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='000000'%3e%3cpath%20d='M120-120v-560h240v-80l120-120%20120%20120v240h240v400H120Zm80-80h80v-80h-80v80Zm0-160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm240%20320h80v-80h-80v80Zm0-160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm240%20480h80v-80h-80v80Zm0-160h80v-80h-80v80Z'/%3e%3c/svg%3e",ht="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='000000'%3e%3cpath%20d='M80-240v-80q38%200%2056.5-20t77.5-20q59%200%2077.5%2020t54.5%2020q38%200%2056.5-20t77.5-20q57%200%2077.5%2020t56.5%2020q38%200%2055.5-20t76.5-20q59%200%2077.5%2020t56.5%2020v80q-57%200-77.5-20T746-280q-36%200-54.5%2020T614-240q-57%200-77.5-20T480-280q-38%200-56.5%2020T346-240q-59%200-76.5-20T214-280q-38%200-56.5%2020T80-240Zm0-160v-80q38%200%2056.5-20t77.5-20q57%200%2076.5%2020t55.5%2020q38%200%2056.5-20t77.5-20q57%200%2077%2020t55%2020q38%200%2056.5-20t77.5-20q57%200%2077.5%2020t56.5%2020v80q-59%200-78.5-20T746-440q-36%200-54.5%2020T614-400q-57%200-77.5-20T480-440q-38%200-55.5%2020T348-400q-59%200-78.5-20T214-440q-36%200-56.5%2020T80-400Zm0-160v-80q38%200%2056.5-20t77.5-20q57%200%2076.5%2020t55.5%2020q38%200%2056.5-20t77.5-20q57%200%2077%2020t55%2020q38%200%2056.5-20t77.5-20q57%200%2077.5%2020t56.5%2020v80q-59%200-78.5-20T746-600q-36%200-54.5%2020T614-560q-57%200-77.5-20T480-600q-38%200-55.5%2020T348-560q-59%200-78.5-20T214-600q-36%200-56.5%2020T80-560Z'/%3e%3c/svg%3e";class b{constructor(){r(this,"useMapFocusPoint",!0);r(this,"mapFocusPointMinZoom",5);r(this,"fixedFocusPoint",null);r(this,"searchOnEnter",!1);r(this,"maxResults",5);r(this,"minInputLength",3);r(this,"minWaitPeriodMs",100);r(this,"layers",null);r(this,"onResultSelected");r(this,"baseUrl",null)}}class yt{constructor(n={}){r(this,"map",null);r(this,"container",null);r(this,"resultsContainer",null);r(this,"resultsList",null);r(this,"input",null);r(this,"clearButton",null);r(this,"loadingSpinner",null);r(this,"api");r(this,"lastRequestAt",0);r(this,"lastRequestString","");r(this,"resultFeatures",[]);r(this,"selectedResultIndex",null);r(this,"originalInput","");r(this,"options",new b);this.options=Object.assign(new b,n),this.api=new ot(new y({basePath:n.baseUrl}))}onAdd(n){return this.map=n,this.container=this.buildInput(),this.container}buildInput(){const n=document.createElement("div");n.className="maplibregl-ctrl stadiamaps-search-box";const e=n.appendChild(document.createElement("div"));e.className="input-container",this.clearButton=e.appendChild(document.createElement("span")),this.clearButton.className="cancel hidden",this.clearButton.addEventListener("click",this.onClear.bind(this)),this.loadingSpinner=e.appendChild(document.createElement("span")),this.loadingSpinner.className="spinner lds-dual-ring hidden",this.input=e.appendChild(document.createElement("input")),this.input.type="text",this.input.placeholder="Search for places...",this.input.addEventListener("input",this.onInput.bind(this)),this.input.addEventListener("focus",this.onFocus.bind(this)),this.input.addEventListener("keydown",this.onKey.bind(this)),this.input.enterKeyHint="search",this.resultsContainer=n.appendChild(document.createElement("div")),this.resultsContainer.className="results hidden",this.resultsList=this.resultsContainer.appendChild(document.createElement("div")),this.resultsList.className="results-list";const o=this.resultsContainer.appendChild(document.createElement("div"));return o.className="search-attribution",o.innerHTML=`<img height="50" width="50" src="${st}" alt="Stadia Maps" class="logo"> Powered by <a href="https://stadiamaps.com/" target="_blank">Stadia Maps</a><br>&copy; <a href="https://www.openstreetmap.org/copyright" target="_blank" rel="nofollow">OpenStreetMap</a> contributors &amp; <a href="https://stadiamaps.com/attribution/" target="_blank">others</a>`,n}getContainer(){return this.container}async onFocus(n){this.resultFeatures.length>0&&this.showResults(),this.maybeShowClearButton()}maybeShowClearButton(){const n=this.input.value.length>0;this.clearButton.classList.toggle("hidden",!n)}async onKey(n){switch(n.key){case"Enter":this.selectedResultIndex!==null?(this.onSelected(this.resultFeatures[this.selectedResultIndex]),this.input.blur()):this.options.searchOnEnter&&await this.onInput(n,!0);break;case"Escape":this.onClear();break;case"ArrowDown":case"ArrowUp":n.preventDefault(),this.handleArrowKey(n.key);break}}handleArrowKey(n){n==="ArrowDown"?this.selectedResultIndex===null?(this.selectedResultIndex=0,this.originalInput=this.input.value):this.selectedResultIndex<this.resultFeatures.length-1&&this.selectedResultIndex++:n==="ArrowUp"&&(this.selectedResultIndex>0?this.selectedResultIndex--:this.selectedResultIndex===0&&(this.selectedResultIndex=null,this.input.value=this.originalInput)),this.updateSelectedResult()}updateSelectedResult(){Array.from(this.resultsList.children).forEach((e,o)=>{o===this.selectedResultIndex?(e.classList.add("hover"),this.input.value=this.resultFeatures[o].properties.name):e.classList.remove("hover")})}async onInput(n,e=!1){this.maybeShowClearButton();const o=this.input.value;if(!o){this.clearResults(),this.hideResults();return}const a=Date.now().valueOf()-this.lastRequestAt;if(this.lastRequestAt===0||a>=this.options.minWaitPeriodMs){if(o.length>=this.options.minInputLength&&(o!==this.lastRequestString||e)){const s={text:o,size:this.options.maxResults};this.options.layers&&(s.layers=this.options.layers);let i=this.options.fixedFocusPoint;this.options.useMapFocusPoint&&this.map.getZoom()>=this.options.mapFocusPointMinZoom&&(i=this.map.getCenter().toArray()),i&&(s.focusPointLon=i[0],s.focusPointLat=i[1]),this.options.layers&&(s.layers=this.options.layers),this.lastRequestString=o;const l=Date.now().valueOf();this.lastRequestAt=l,this.container.classList.toggle("loading",!0);try{let h;if(e?h=await this.api.search(s):h=await this.api.autocomplete(s),this.lastRequestAt===l)if(this.clearResults(),this.resultFeatures=h.features,this.resultFeatures.length>0)for(const v of this.resultFeatures)this.addResult(v);else this.onNoResults()}catch(h){console.warn(`Something when wrong with the request: ${h}`)}finally{this.lastRequestAt===l&&this.container.classList.toggle("loading",!1)}}}else setTimeout(()=>{this.onInput(n,e)},this.options.minWaitPeriodMs)}onNoResults(){this.showResults();const n=document.createElement("div");n.className="result no-result",n.textContent="No Results Found",this.resultsList.appendChild(n)}onSelected(n){if(n.bbox!==void 0)this.map.fitBounds([[n.bbox[0],n.bbox[1]],[n.bbox[2],n.bbox[3]]]);else{let e;switch(n.properties.layer){case"venue":case"address":e=15;break;case"marinearea":case"locality":e=12;break;case"empire":case"macrocounty":case"country":e=4;break;case"dependency":case"county":e=10;break;case"continent":case"ocean":e=2;break;case"macroregion":case"region":e=7;break;case"borough":case"localadmin":e=12;break;case"macrohood":case"postalcode":case"neighbourhood":case"street":e=14;break;default:e=10}this.map.flyTo({center:[n.geometry.coordinates[0],n.geometry.coordinates[1]],zoom:e})}this.hideResults(),this.options.onResultSelected&&this.options.onResultSelected(n)}onClear(){this.input.value="",this.maybeShowClearButton(),this.clearResults(),this.hideResults(),this.input.focus()}subtitle(n){let e=[];switch(n.layer){case"venue":case"address":case"street":case"neighbourhood":case"postalcode":case"macrohood":e=[n.locality??n.region,n.country];break;case"country":case"dependency":case"disputed":e=[n.continent];break;case"macroregion":case"region":e=[n.country];break;case"macrocounty":case"county":case"locality":case"localadmin":case"borough":e=[n.region,n.country];break}return e.filter(o=>o!=null).join(", ")}icon(n){switch(n.layer){case"venue":return at;case"address":return rt;case"street":return it;case"postalcode":return lt;case"localadmin":case"locality":case"borough":case"neighbourhood":case"macrohood":case"coarse":return dt;case"county":case"macroregion":case"macrocounty":case"region":case"country":case"dependency":case"disputed":return ct;case"empire":case"continent":return ut;case"marinearea":case"ocean":return ht}}buildResult(n){const e=document.createElement("div");e.className="result",e.onclick=()=>{this.selectedResultIndex=this.resultFeatures.indexOf(n),this.updateSelectedResult(),this.onSelected(n)},e.title=n.properties.name;const o=e.appendChild(document.createElement("img"));o.src=this.icon(n.properties),o.className="result-icon";const a=e.appendChild(document.createElement("div"));a.textContent=n.properties.name,a.className="result-label";const s=e.appendChild(document.createElement("div"));return s.className="result-extra",s.textContent=this.subtitle(n.properties),e}addResult(n){this.showResults(),this.resultsList.appendChild(this.buildResult(n))}hideResults(){this.resultsContainer.classList.toggle("hidden",!0)}showResults(){this.resultsContainer.classList.toggle("hidden",!1)}clearResults(){this.resultFeatures=[],this.resultsList.replaceChildren(""),this.selectedResultIndex=null,this.originalInput=""}onRemove(n){var e,o;n._container&&((o=(e=this.container)==null?void 0:e.parentNode)==null||o.removeChild(this.container)),this.container=null,this.map=null}}c.MapLibreSearchControl=yt,c.MapLibreSearchControlOptions=b,Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=maplibre-search-box.umd.js.map
